!function(){"use strict";class e{constructor(e,t){let{items:r,renderer:o}=e;this._renderer=o,this._initialArray=r,this._container=document.querySelector(t)}renderItems(){this._initialArray.forEach(this._renderer)}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}class t{constructor(e){this._modal=document.querySelector(e),this._modalClose=this._modal.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){window.addEventListener("keydown",this._handleEscClose),this._modal.classList.add("modal_open")}close(){this._modal.classList.remove("modal_open"),window.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._modalClose.addEventListener("click",(()=>this.close())),this._modal.addEventListener("mousedown",(e=>{e.target.classList.contains("modal_open")&&this.close()}))}}class r extends t{constructor(e){let{modalSelector:t,handleFormSubmit:r}=e;super(t),this._form=this._modal.querySelector(".modal__form"),this._handleFormSubmit=r,this._inputList=this._form.querySelectorAll(".modal__input"),this.setEventListeners()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setSubmitAction(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}reset(){this._form.reset()}close(){super.close()}}class o{constructor(e){let{data:t,selector:r,clickEventHandler:o,deleteEventHandler:s,likeEventHandler:n}=e;this._src=t.link,this._alt=t.name,this._textContent=t.name,this._likes=t.likes,this._ownerInd=t.ownerInd,this._cardLiked=t.cardLiked,this._selector=r,this._clickEventHandler=o,this._deleteEventHandler=s,this._likeEventHandler=n}_getTemplate(){return document.querySelector(this._selector).content.querySelector(".card").cloneNode(!0)}_fillImageCard(){this._cardImage.src=this._src,this._cardImage.alt=this._alt,this._cardLabel.textContent=this._textContent,this._cardLikes.textContent=this._likes,this._cardLiked?this.likeCard():this.unlikeCard(),this._ownerInd||this._deleteCardButton.classList.add("card__delete_disable")}_handleDeleteCard(e){this._deleteEventHandler()}setEventListeners(){this._cardImage.addEventListener("click",(()=>{this._clickEventHandler()})),this._ownerInd&&this._deleteCardButton.addEventListener("click",(e=>{this._deleteEventHandler()})),this._cardLikeButton.addEventListener("click",(e=>{this._likeEventHandler()}))}likeCard(){this._cardLikeButton.classList.add("card__heart_like"),this._cardLiked=!0}unlikeCard(){this._cardLikeButton.classList.remove("card__heart_like"),this._cardLiked=!1}isCardLiked(){return this._cardLiked}removeCardElement(){this._element.remove()}updateLikes(e){this._cardLikes.textContent=e}getCardElement(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._cardLikeButton=this._element.querySelector(".card__heart"),this._deleteCardButton=this._element.querySelector(".card__delete"),this._cardLabel=this._element.querySelector(".card__label-text"),this._cardLikes=this._element.querySelector(".card__likes"),this._fillImageCard(),this.setEventListeners(),this._element}}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class n{constructor(e,t){s(this,"_showInputError",((e,t)=>{const r=this._formElement.querySelector(`#${e.id}-error`);r.textContent=t,r.classList.add(this._configDict.errorClass)})),s(this,"_hideInputError",(e=>{const t=this._formElement.querySelector(`#${e.id}-error`);t.classList.remove(this._configDict.errorClass),t.textContent=""})),s(this,"_hasInValidInput",(()=>this._inputList.some((e=>!e.validity.valid)))),s(this,"_toggleButtonState",(()=>{this._hasInValidInput()?this._disableSubmit():(this._buttonElement.classList.remove(this._configDict.inactiveButtonClass),this._buttonElement.removeAttribute("disabled",!0))})),s(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),s(this,"_disableSubmit",(()=>{this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._configDict.inactiveButtonClass)})),s(this,"enableValidation",(()=>{this._setEventListeners()})),s(this,"resetValidation",(()=>{this._inputList.forEach((e=>{this._hideInputError(e)})),this._disableSubmit()})),this._configDict=e,this._formElement=t}_setEventListeners(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._inputList=Array.from(this._formElement.querySelectorAll(this._configDict.inputSelector)),this._buttonElement=this._formElement.querySelector(this._configDict.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._formElement.addEventListener("reset",(()=>{this._disableSubmit()}))}}class i{constructor(e){this._options=e}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error updating user information: ${e.status}`)}getInitialCards(){return fetch(`${this._options.baseUrl}/cards`,{headers:this._options.headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._options.baseUrl}/users/me`,{headers:this._options.headers}).then(this._checkResponse)}updateUserInfo(){return fetch(`${this._options.baseUrl}/users/me`,{method:"PATCH",headers:this._options.headers,body:this._options.body}).then(this._checkResponse)}addNewPicture(){return fetch(`${this._options.baseUrl}/cards `,{method:"POST",headers:this._options.headers,body:this._options.body}).then(this._checkResponse)}deleteCard(){return fetch(`${this._options.baseUrl}/cards/${this._options.cardId}`,{method:"DELETE",headers:this._options.headers}).then(this._checkResponse)}updateLikeCard(){return this._options.cardLiked?fetch(`${this._options.baseUrl}/cards/likes/${this._options.cardId}`,{method:"DELETE",headers:this._options.headers}).then(this._checkResponse):fetch(`${this._options.baseUrl}/cards/likes/${this._options.cardId}`,{method:"PUT",headers:this._options.headers}).then(this._checkResponse)}updateAvatar(){return fetch(`${this._options.baseUrl}/users/me/avatar`,{method:"PATCH",body:this._options.body,headers:this._options.headers}).then(this._checkResponse)}performPromiseAll(e){return Promise.all(e)}}const a={formSelector:".modal__form",inputSelector:".modal__input",inputErrorSelector:".modal__input-error",submitButtonSelector:".modal__submit",inactiveButtonClass:"modal__submit_inactive",errorClass:"modal__input-error_display"},l=Array.from(document.querySelectorAll(a.formSelector)),d=document.querySelector(".profile__pen"),c=document.querySelector(".profile__name"),h=document.querySelector(".profile__name-tag"),_=document.querySelector(".profile__avatar"),u=document.querySelector(".profile__avatar-edit"),m=(document.querySelector("#avatar-edit"),document.querySelector("#profile-edit")),p=m.querySelector(".modal__form").name,f=m.querySelector("#profile-modal-name"),b=m.querySelector("#profile-modal-job"),v=document.querySelector(".profile__add-button"),E={};l.forEach((e=>{const t=new n(a,e);E[e.name]=t,t.enableValidation()}));const S=new class{constructor(e){let{nameSelector:t,jobSelector:r}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(r)}getUserInfo(){return{profileName:this._profileName.textContent,profileJob:this._profileJob.textContent}}setUserInfo(e,t){this._profileName.textContent=e,this._profileJob.textContent=t}}({nameSelector:".profile__name",jobSelector:".profile__name-tag"}),k=document.querySelector("#profile-edit").querySelector(".modal__submit"),g=k.textContent,y=new r({modalSelector:"#profile-edit",handleFormSubmit:e=>{k.textContent="Saving...";const t={baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"51b8259d-f8d1-4b7c-b443-194620edca24","Content-Type":"application/json"},body:JSON.stringify({name:e["profile-modal-name"],about:e["profile-modal-job"]})};new i(t).updateUserInfo().then((e=>{S.setUserInfo(e.name,e.about),k.textContent=g,y.close()})).catch((e=>{console.log(e),y.close()}))}});d.addEventListener("click",(function(){E[p].resetValidation(),function(){const e=S.getUserInfo();f.value=e.profileName,b.value=e.profileJob}(),y.open()}));const L=new class extends t{constructor(e){super(e),this._modalImage=this._modal.querySelector(".modal__image-expanded"),this._modalText=this._modal.querySelector(".modal__image-label"),super.setEventListeners()}open(e){let{src:t,alt:r}=e;this._modalImage.src=t,this._modalImage.alt=r,this._modalText.textContent=r,super.open()}}("#image-modal"),C=new r({modalSelector:"#delete-card-confirmation",handleFormSubmit:()=>{}});function I(e){const t=new o({data:e,selector:"#card",clickEventHandler:()=>{L.open({src:e.link,alt:e.name})},deleteEventHandler:()=>{const r={baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"51b8259d-f8d1-4b7c-b443-194620edca24"},cardId:e.imageId};C.open(),C.setSubmitAction((()=>{new i(r).deleteCard().then((e=>{t.removeCardElement(),C.close()})).catch((e=>console.log(e)))}))},likeEventHandler:()=>{const r={baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"51b8259d-f8d1-4b7c-b443-194620edca24"},cardId:e.imageId,cardLiked:t.isCardLiked()};new i(r).updateLikeCard().then((e=>{P(e.likes)?t.likeCard():t.unlikeCard(),t.updateLikes(e.likes.length)})).catch((e=>{console.log(e)}))}});return t}const w=document.querySelector("#add-card").querySelector(".modal__submit"),q=w.textContent,x=new r({modalSelector:"#add-card",handleFormSubmit:e=>{w.textContent="Saving...";const t={name:e["add-card-title"],link:e["add-card-image-url"]},r={baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"51b8259d-f8d1-4b7c-b443-194620edca24","Content-Type":"application/json"},body:JSON.stringify(t)};new i(r).addNewPicture().then((e=>{const t=I({name:e.name,link:e.link,ownerInd:!0,cardLiked:!1,likes:0,imageId:e._id}).getCardElement();H.prependItem(t),w.textContent=q,x.reset(),x.close()})).catch((e=>{console.log(e),x.close()}))}});v.addEventListener("click",(function(){x.open()}));const U=document.querySelector("#avatar-edit").querySelector(".modal__submit"),A=U.textContent,B=new r({modalSelector:"#avatar-edit",handleFormSubmit:e=>{const t={avatar:e["avatar-url"]},r={baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"51b8259d-f8d1-4b7c-b443-194620edca24","Content-Type":"application/json"},body:JSON.stringify(t)};U.textContent="Saving...",new i(r).updateAvatar().then((t=>{!function(e){const t=_.src;_.src=e,_.onerror=()=>{_.src=t,console.log("Error: Not able to load new Avatar. Avatar unchanged!!")}}(e["avatar-url"]),U.textContent=A,B.close()})).catch((e=>{U.textContent=A,console.log(e),B.close()}))}});_.addEventListener("mouseover",(e=>{u.classList.add("profile__avatar-edit_show")})),u.addEventListener("mouseout",(e=>{u.classList.remove("profile__avatar-edit_show")})),u.addEventListener("click",(e=>{B.open()}));let H="";const $={};function P(e){for(let t=0;t<e.length;t++)if(e[t]._id==$._id)return!0;return!1}!function(){const t=[],r={baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"51b8259d-f8d1-4b7c-b443-194620edca24"}},o=new i(r).getInitialCards().then((e=>e)).catch((e=>{console.log(e)})),s=new i(r).getUserInfo().then((e=>e)).catch((e=>{console.log(e)}));new i(r).performPromiseAll([o,s]).then((r=>{$.name=r[1].name,$.about=r[1].about,$.avatar=r[1].avatar,$._id=r[1]._id,r[0].forEach((e=>{const r=$._id===e.owner._id,o=P(e.likes);t.push({name:e.name,link:e.link,likes:e.likes.length,ownerInd:r,imageId:e._id,cardLiked:o})})),function(t,r){c.textContent=t.name,h.textContent=t.about,_.src=t.avatar,_.alt=`Profile of ${t.name}`,_.onload=()=>{!function(t){H=new e({items:t,renderer:e=>{const t=I(e).getCardElement();H.addItem(t)}},".content__list"),H.renderItems()}(r)},_.onerror=()=>console.log("Error: Not able to load Avatar!!")}($,t)}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU1vRCxFQUFXdUosRUFBWVgsTUFBUWhNLEVBQVFnTixNQUFNaEIsSUFFN0MxSSxFQUFZb0ksRUFBYzFMLEVBQVFrRCxPQUV4QzJKLEVBQWFJLEtBQUssQ0FDaEJoTCxLQUFNakMsRUFBUWlDLEtBQ2RhLEtBQU05QyxFQUFROEMsS0FDZEksTUFBT2xELEVBQVFrRCxNQUFNeUksT0FDckJ2SSxTQUFVQSxFQUNWb0ksUUFBU3hMLEVBQVFnTSxJQUNqQjFJLFVBQVdBLEdBQ1gsSUFsR1IsU0FBd0JxSixFQUFhRSxHQUNuQ2pFLEVBQVl6RSxZQUFjd0ksRUFBWTFLLEtBQ3RDNEcsRUFBZTFFLFlBQWN3SSxFQUFZbkMsTUFDekMxQixFQUFjOUUsSUFBTTJJLEVBQVlMLE9BQ2hDeEQsRUFBYzdFLElBQU8sY0FBYTBJLEVBQVkxSyxPQUU5QzZHLEVBQWNvRSxPQUFTLE1BdkV6QixTQUF5QkwsR0FDdkJaLEVBQVksSUFBSS9NLEVBQ2QsQ0FDRUcsTUFBT3dOLEVBQ1B2TixTQUFXZ00sSUFDVCxNQUNNUyxFQURPVixFQUFXQyxHQUNDdkcsaUJBQ3pCa0gsRUFBVWxNLFFBQVFnTSxFQUFZLEdBR2xDLGtCQUdGRSxFQUFVcE0sYUFDWixDQTBESXNOLENBQWdCTixFQUFhLEVBRS9CL0QsRUFBYzJELFFBQVUsSUFBTTdCLFFBQVFDLElBQUksbUNBQzVDLENBMkZJdUMsQ0FBZVQsRUFBYUUsRUFBYSxHQUU3QyxDQUVBUSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5faW5pdGlhbEFycmF5ID0gaXRlbXM7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgcHJlcGVuZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG5cbmV4cG9ydCB7IFNlY3Rpb24gfTtcbiIsImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IobW9kYWxTZWxlY3Rvcikge1xuICAgIHRoaXMuX21vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9tb2RhbENsb3NlID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG4gICAgLy8gSSBoYXZlIHRvIHVzZSB0aGlzIHN0bXQgdG8gaGFuZGxlIHRoZSBlc2Mga2V5XG4gICAgLy8gZWxzZSB0aGUgd2hvbGUgd2luZG93IGlzIGdldHRpbmcgY2xvc2VkLlxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9tb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlblwiKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuXCIpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICAvKiogVG8gdGhlIHJldmlld2VyKi9cbiAgLyoqXG4gICAqIFlvdSBzdWdnZXN0ZWQgbWUgdG8gbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXJzIHNldHRpbmcgdG8gb3BlbigpXG4gICAqIGFuZCByZW1vdmUgdGhlIGV2ZW50IGxpc3RlbmVycyBpbiBjbG9zZSgpLlxuICAgKiBJdCdzIGEgZ3JlYXQgc3VnZ2VzdGlvbi4gSG93ZXZlciwgSSBhbSB1c2luZyBhbm9ueW1vdXMgZnVuY3Rpb25cbiAgICogdG8gdGhlIGV2ZW50IGxpc3RlbmVycy4gRG8gSSBuZWVkIHRvIHJlcGVhdCB0aGUgY29kZSBhZ2FpbiBpblxuICAgKiByZW1vdmVFdmVudExpc3RlbmVyP1xuICAgKi9cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbW9kYWxDbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcblxuICAgIHRoaXMuX21vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlblwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IHsgUG9wdXAgfTtcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBtb2RhbFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIC8vdGhpcy5zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX3N1Ym1pdFwiKTtcbiAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xuXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24obmV3U3VibWl0SGFuZGxlKSB7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IG5ld1N1Ym1pdEhhbmRsZTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0KCkge1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgfVxuXG4gIC8qKlRvIHRoZSBSZXZpZXdlciAoc3ByaW50LTgpOlxuICAgKiBJIG1hZGUgY2hhbmdlcyBhcyBwZXIgeW91ciBzdWdnZXN0aW9uLiBSZW1vdmVkIHJlc2V0KCkgZnVuY3Rpb24sXG4gICAqIGFuZCBhZGRlZCBsaW5lIHRvIHJlc2V0IHRoZSBmb3JtIGluIGNsb3NlKCkgaXRzZWxmLlxuICAgKiBIb3dldmVyLCBob3cgY2FuIEkgaGFuZGxlIHRoZSBmdW5jdGlvbmFsaXR5IG9mIG5vdCB0b1xuICAgKiByZXNldCB0aGUgZm9ybSAodG8gc2F2ZSB0aGUgZWFybGllciB0eXBlZCBkYXRhPykuXG4gICAqIEZvciBleGFtcGxlLCBpbiB0aGUgbmV3IGltYWdlcyBhZGQgZnVuY3Rpb25hbGl0eSwgYWZ0ZXIgdHlwaW5nIHRoZSBkYXRhLFxuICAgKiBpZiB0aGUgdXNlciBjbG9zZXMgdGhlIGZvcm0sIGFuZCB0aGVuIGFnYWluIGNsaWNrcyB0aGUgYWRkIGltYWdlIGJ1dHRvbixcbiAgICogdGhlIG9wZW5lZCBmb3JtIHNob3VsZCByZXN0b3JlIHRoZSBlYXJsaWVyIHR5cGVkIGRhdGEuXG4gICAqIFdpdGggdGhlIHN1Z2dlc3RlZCBjaGFuZ2VzIEkgYW0gbm90IGFibGUgdG8gbG9hZCB0aGUgcHJldmlvdXNseSB0eXBlZFxuICAgKiB2YWx1ZXMgZm9yIHRoZSBuZXcgaW1hZ2UgdXBsb2FkIGZvcm0uXG4gICAqL1xuICAvKlNwcmludCA5OiBEbyBub3QgcmVzZXQgdGhlIGZvcm0gYWZ0ZXIgY2xvc2UsIGFzIGl0IHdpbGwgXG4gIGRpc2FibGUgdGhlIHN1Ym1pdCBidXR0b24gZm9yIHRoZSBpbWFnZSBkZWxldGUgcmVjb25maXJtYXRpb24gbW9kYWwqL1xuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIC8vdGhpcy5fZm9ybS5yZXNldCgpO1xuICB9XG59XG5cbmV4cG9ydCB7IFBvcHVwV2l0aEZvcm0gfTtcbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgZGF0YSxcbiAgICBzZWxlY3RvcixcbiAgICBjbGlja0V2ZW50SGFuZGxlcixcbiAgICBkZWxldGVFdmVudEhhbmRsZXIsXG4gICAgbGlrZUV2ZW50SGFuZGxlcixcbiAgfSkge1xuICAgIHRoaXMuX3NyYyA9IGRhdGEubGluaztcbiAgICB0aGlzLl9hbHQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fdGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX293bmVySW5kID0gZGF0YS5vd25lckluZDtcbiAgICB0aGlzLl9jYXJkTGlrZWQgPSBkYXRhLmNhcmRMaWtlZDtcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgIHRoaXMuX2NsaWNrRXZlbnRIYW5kbGVyID0gY2xpY2tFdmVudEhhbmRsZXI7XG4gICAgdGhpcy5fZGVsZXRlRXZlbnRIYW5kbGVyID0gZGVsZXRlRXZlbnRIYW5kbGVyO1xuICAgIHRoaXMuX2xpa2VFdmVudEhhbmRsZXIgPSBsaWtlRXZlbnRIYW5kbGVyO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIF9maWxsSW1hZ2VDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9zcmM7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX2FsdDtcbiAgICB0aGlzLl9jYXJkTGFiZWwudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0Q29udGVudDtcbiAgICB0aGlzLl9jYXJkTGlrZXMudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcztcbiAgICBpZiAodGhpcy5fY2FyZExpa2VkKSB7XG4gICAgICB0aGlzLmxpa2VDYXJkKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudW5saWtlQ2FyZCgpO1xuICAgIH1cbiAgICAvLyBSZW1vdmUgdGhlIGRlbGV0ZSBidXR0b24sIGlmIHRoZSB1c2VyIGlzIG5vdCB0aGUgb3duZXIgb2YgdGhlXG4gICAgLy8gcGhvdG9cbiAgICBpZiAoIXRoaXMuX293bmVySW5kKSB7XG4gICAgICB0aGlzLl9kZWxldGVDYXJkQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19kZWxldGVfZGlzYWJsZVwiKTtcbiAgICB9XG4gIH1cblxuICAvL19oYW5kbGVUb2dnbGVMaWtlKGV2ZW50KSB7XG4gIC8vICBldmVudC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2hlYXJ0X2xpa2VcIik7XG4gIC8vfVxuXG4gIF9oYW5kbGVEZWxldGVDYXJkKGV2ZW50KSB7XG4gICAgdGhpcy5fZGVsZXRlRXZlbnRIYW5kbGVyKCk7XG4gICAgLy9ldmVudC50YXJnZXQuY2xvc2VzdChcIi5jYXJkXCIpLnJlbW92ZSgpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9jbGlja0V2ZW50SGFuZGxlcigpO1xuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMuX293bmVySW5kKSB7XG4gICAgICB0aGlzLl9kZWxldGVDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICAgIHRoaXMuX2RlbGV0ZUV2ZW50SGFuZGxlcigpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIC8vdGhpcy5faGFuZGxlVG9nZ2xlTGlrZShldnQpO1xuICAgICAgLy9pZiAoIWV2dC5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19oZWFydF9saWtlXCIpKSB7XG4gICAgICAvLyAgdGhpcy5saWtlQ2FyZChldnQpO1xuICAgICAgLy99IGVsc2Uge1xuICAgICAgLy8gIHRoaXMucmV2ZXJ0TGlrZUNhcmQoZXZ0KTtcbiAgICAgIC8vIH1cbiAgICAgIHRoaXMuX2xpa2VFdmVudEhhbmRsZXIoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGxpa2VDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19oZWFydF9saWtlXCIpO1xuICAgIHRoaXMuX2NhcmRMaWtlZCA9IHRydWU7XG4gIH1cblxuICB1bmxpa2VDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19oZWFydF9saWtlXCIpO1xuICAgIHRoaXMuX2NhcmRMaWtlZCA9IGZhbHNlO1xuICB9XG5cbiAgaXNDYXJkTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRMaWtlZDtcbiAgfVxuXG4gIHJlbW92ZUNhcmRFbGVtZW50KCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICB1cGRhdGVMaWtlcyhsaWtlcykge1xuICAgIHRoaXMuX2NhcmRMaWtlcy50ZXh0Q29udGVudCA9IGxpa2VzO1xuICB9XG5cbiAgZ2V0Q2FyZEVsZW1lbnQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2hlYXJ0XCIpO1xuICAgIHRoaXMuX2RlbGV0ZUNhcmRCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlXCIpO1xuXG4gICAgdGhpcy5fY2FyZExhYmVsID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xhYmVsLXRleHRcIik7XG4gICAgdGhpcy5fY2FyZExpa2VzID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VzXCIpO1xuICAgIHRoaXMuX2ZpbGxJbWFnZUNhcmQoKTtcbiAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuXG5leHBvcnQgeyBDYXJkIH07XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnRGljdCwgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb25maWdEaWN0ID0gY29uZmlnRGljdDtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgLy8gSW4gdGhlIGJlbG93IGZ1bmN0aW9uczpcbiAgLy8gZm9ybUVsZW1lbnQgcmVwcmVzZW50cyBhIGZvcm1cbiAgLy8gaW5wdXRFbGVtZW50IHJlcHJlc2VudHMgYSBzcGVjaWZpYyBpbnB1dCBlbGVtZW50IGluIHRoZSBmb3JtXG4gIC8vIGVycm9yTWVzc2FnZSByZXByZXNlbnRzIHRoZSBlcnJvciBtZXNzYWdlIGZvciB0aGUgY29ycmVzcG9uZGluZyBpbnB1dCBmaWVsZFxuXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWdEaWN0W1wiZXJyb3JDbGFzc1wiXSk7XG4gIH07XG5cbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZ0RpY3RbXCJlcnJvckNsYXNzXCJdKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9O1xuXG4gIF9oYXNJblZhbGlkSW5wdXQgPSAoKSA9PiB7XG4gICAgLy9pbnB1dExpc3QgaXMgYSBsaXN0IG9mIGlucHV0IGZpZWxkcyBiZWxvbmdpbmcgdG8gYSBmb3JtXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9O1xuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5faGFzSW5WYWxpZElucHV0KCkpIHtcbiAgICAgIC8vIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAvLyB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoXG4gICAgICAvLyB0aGlzLl9jb25maWdEaWN0W1wiaW5hY3RpdmVCdXR0b25DbGFzc1wiXVxuICAgICAgLy8gKTtcbiAgICAgIHRoaXMuX2Rpc2FibGVTdWJtaXQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFxuICAgICAgICB0aGlzLl9jb25maWdEaWN0W1wiaW5hY3RpdmVCdXR0b25DbGFzc1wiXVxuICAgICAgKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgfVxuICB9O1xuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgLy8gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlIGlzIGF1dG8tY3JlYXRlZCBieSB0aGUgYnJvd3NlciBiYXNlZCBvbiB0aGUgdmFsaWRhdGlvbiBlcnJvclxuICAgIC8vIGNvbnN0IGlucHV0RWxlbWVudCA9IGV2dC50YXJnZXQ7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH07XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWdEaWN0W1wiaW5wdXRTZWxlY3RvclwiXSlcbiAgICApO1xuXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jb25maWdEaWN0W1wic3VibWl0QnV0dG9uU2VsZWN0b3JcIl1cbiAgICApO1xuXG4gICAgLy8gVGhpcyBzdGF0ZW1lbnQgd2lsbCBoZWxwIHRvIHNldCB0aGUgYnV0dG9uIHN0YXRlIGFwcHJvcHJpYXRlbHksIHdoZW4gdGhlXG4gICAgLy8gcGFnZSBsb2FkcyBpbml0aWFsbHlcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuXG4gICAgLy8gWW91IG11c3QgdXNlIGFycm93IGZ1bmN0aW9uLiBJZiBub3QgdXNlZCwgd2Ugd2lsbCBnZXQgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KCkgbm90IGZvdW5kIGVycm9yXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBXaGVuZXZlciBhIGZvcm0gaXMgcmVzZXQsIHRoZSBidXR0b24gd2lsbCBiZSBkaXNhYmxlZCwgdXNpbmcgdGhlIGZvbGxvd2luZyByZXNldCBldmVudCBoYW5kbGVyLlxuICAgIC8vIEFsdGVybmF0aXZlbHkgd2UgY2FuIGRpc2FibGUgdGhlIGJ1dHRvbiB3aGVuIHRoZSBtb2RhbCBpcyBvcGVuZWQgZm9yIGRpc3BsYXkuXG4gICAgLy8gU2VlIHRoZSBmdW5jdGlvbiAoc2VlIHRoZSBmdW5jdGlvbjogaGFuZGxlQ3JlYXRlQ2FyZFN1Ym1pdChldmVudCkgaW4gaW5kZXguanMpXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcbiAgICAgIC8vIGBzZXRUaW1lb3V0YCBpcyBuZWVkZWQgdG8gd2FpdCB0aWxsIHRoZSBmb3JtIGlzIGZ1bGx5IHJlc2V0IGFuZCB0aGVuIHRvIGNhbGwgYHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKClgXG4gICAgICAvL3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgLy8gIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAvL30sIDApOyAvLyBpdOKAmXMgZW5vdWdoIHRvIHB1dCAwIG1zIGhlcmVcbiAgICAgIHRoaXMuX2Rpc2FibGVTdWJtaXQoKTtcbiAgICB9KTtcbiAgfVxuXG4gIF9kaXNhYmxlU3VibWl0ID0gKCkgPT4ge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZ0RpY3RbXCJpbmFjdGl2ZUJ1dHRvbkNsYXNzXCJdKTtcbiAgfTtcblxuICBlbmFibGVWYWxpZGF0aW9uID0gKCkgPT4ge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH07XG5cbiAgcmVzZXRWYWxpZGF0aW9uID0gKCkgPT4ge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihlbGVtZW50KTtcbiAgICB9KTtcbiAgICB0aGlzLl9kaXNhYmxlU3VibWl0KCk7XG4gIH07XG59XG5cbmV4cG9ydCB7IEZvcm1WYWxpZGF0b3IgfTtcbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcbiAgfVxuXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yIHVwZGF0aW5nIHVzZXIgaW5mb3JtYXRpb246ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIC8vIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xuICAvLyAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIC8vIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX29wdGlvbnMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9vcHRpb25zLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9vcHRpb25zLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5fb3B0aW9ucy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fb3B0aW9ucy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5fb3B0aW9ucy5oZWFkZXJzLFxuICAgICAgYm9keTogdGhpcy5fb3B0aW9ucy5ib2R5LFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGROZXdQaWN0dXJlKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9vcHRpb25zLmJhc2VVcmx9L2NhcmRzIGAsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9vcHRpb25zLmhlYWRlcnMsXG4gICAgICBib2R5OiB0aGlzLl9vcHRpb25zLmJvZHksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX29wdGlvbnMuYmFzZVVybH0vY2FyZHMvJHt0aGlzLl9vcHRpb25zLmNhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9vcHRpb25zLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZUxpa2VDYXJkKCkge1xuICAgIGlmICh0aGlzLl9vcHRpb25zLmNhcmRMaWtlZCkge1xuICAgICAgcmV0dXJuIGZldGNoKFxuICAgICAgICBgJHt0aGlzLl9vcHRpb25zLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7dGhpcy5fb3B0aW9ucy5jYXJkSWR9YCxcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9vcHRpb25zLmhlYWRlcnMsXG4gICAgICAgIH1cbiAgICAgICkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZldGNoKFxuICAgICAgICBgJHt0aGlzLl9vcHRpb25zLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7dGhpcy5fb3B0aW9ucy5jYXJkSWR9YCxcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9vcHRpb25zLmhlYWRlcnMsXG4gICAgICAgIH1cbiAgICAgICkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVBdmF0YXIoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX29wdGlvbnMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBib2R5OiB0aGlzLl9vcHRpb25zLmJvZHksXG4gICAgICBoZWFkZXJzOiB0aGlzLl9vcHRpb25zLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHBlcmZvcm1Qcm9taXNlQWxsKHByb21pc2VMaXN0KSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VMaXN0KTtcbiAgfVxufVxuXG5leHBvcnQgeyBBcGkgfTtcbiIsImltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xuXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcblxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcblxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcblxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuXG5pbXBvcnQgeyBBcGkgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcblxuLy9pbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwXCI7XG5cbi8vIEdsb2JhbCBkaWN0IGZvciB2YWxpZGF0aW9uIG9mIGZvcm0gZWxlbWVudHNcbmNvbnN0IGNvbmZpZ0RpY3QgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIGlucHV0RXJyb3JTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0LWVycm9yXCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0XCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdF9pbmFjdGl2ZVwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvcl9kaXNwbGF5XCIsXG59O1xuXG4vLyBHbG9iYWwgdmFyaWFibGUgdG8gc2VsZWN0IGFsbCBmb3Jtc1xuLy8gQWxzbyBjb252ZXJ0IHRoZSBwc2V1ZG8gYXJyYXkgdG8gbm9ybWFsIGFycmF5IHVzaW5nIEFycmF5LmZyb20oKS5cbi8vIFdpdGhvdXQgdXNpbmcgQXJyYXkuZnJvbSgpLCB3ZSBjYW5ub3QgcGFyc2UgdGhyb3VnaCB0aGUgZm9ybXMgdG8gZW5hYmxlXG4vLyBpbnB1dCBmaWVsZCB2YWxpZGF0aW9uXG5jb25zdCBhbGxGb3JtcyA9IEFycmF5LmZyb20oXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnRGljdFtcImZvcm1TZWxlY3RvclwiXSlcbik7XG5cbi8vIEdsb2JhbCB2YXJpYWJsZXMgdG8gc3VwcG9ydCBQcm9maWxlIGVkaXRpbmcvc2F2aW5nXG5jb25zdCBwcm9maWxlUGVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19wZW5cIik7XG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lVGFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lLXRhZ1wiKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcbmNvbnN0IGF2YXRhckVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1lZGl0XCIpO1xuY29uc3QgYXZhdGFyRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItZWRpdFwiKTtcblxuY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXRcIik7XG5jb25zdCBwcm9maWxlRm9ybUVsZW1lbnQgPSBwcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IHByb2ZpbGVGb3JtTmFtZSA9IHByb2ZpbGVGb3JtRWxlbWVudFtcIm5hbWVcIl07XG5jb25zdCBwcm9maWxlTW9kYWxOYW1lSW5wdXQgPSBwcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW1vZGFsLW5hbWVcIik7XG5jb25zdCBwcm9maWxlTW9kYWxKb2JJbnB1dCA9IHByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbW9kYWwtam9iXCIpO1xuXG4vLyBHbG9iYWwgdmFyaWFibGVzIGZvciBjYXJkIHRlbXBsYXRlXG5jb25zdCBjYXJkVGVtcGxhdGVJRCA9IFwiI2NhcmRcIjtcblxuLy8gR2xvYmFsIHZhcmlhYmxlIGZvciBhbGwgY2FyZHMgY29udGFpbmVyXG4vLyBjb25zdCBjb250ZW50TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudF9fbGlzdFwiKTtcblxuLy8gR2xvYmFsIHZhcmlhYmxlcyB0byBzdXBwb3J0IG5ldyBjYXJkIGFkZGl0aW9uIGxvZ2ljXG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuLy9jb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkXCIpO1xuXG4vL2NvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuLy9jb25zdCBhZGRDYXJkRm9ybU5hbWUgPSBhZGRDYXJkRm9ybUVsZW1lbnRbXCJuYW1lXCJdO1xuLy9jb25zdCBjYXJkVGl0bGUgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC10aXRsZVwiKTtcbi8vY29uc3QgY2FyZFVSTCA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWltYWdlLXVybFwiKTtcblxuLy8gQWRkIGZvcm1zIGlucHV0IHZhbGlkYXRvcnNcbi8vIGZvcm1WYWxpZGF0b3JzIG9iamVjdHMgd2lsbCBjb250YWluIHRoZSBmb3JtIG5hbWUgYXMgdGhlIGtleVxuLy8gYW5kIEZvcm1WYWxpZGF0b3Igb2JqZWN0IGFzIGl0cyB2YWx1ZS5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmFsbEZvcm1zLmZvckVhY2goKGZvcm0pID0+IHtcbiAgY29uc3QgZm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZ0RpY3QsIGZvcm0pO1xuICBmb3JtVmFsaWRhdG9yc1tmb3JtW1wibmFtZVwiXV0gPSBmb3JtVmFsaWRhdG9yO1xuICBmb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbn0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZS10YWdcIixcbn0pO1xuXG5jb25zdCBwcm9maWxlRWRpdFN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50XG4gIC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdFwiKVxuICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0XCIpO1xuXG5jb25zdCBwcm9maWxlRWRpdFN1Ym1pdEJ1dHRvblRleHRPcmlnaW5hbCA9IHByb2ZpbGVFZGl0U3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuXG4vLyBDcmVhdGUgcHJvZmlsZUZvcm0gb2JqZWN0XG5jb25zdCBwcm9maWxlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgbW9kYWxTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0XCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dHMpID0+IHtcbiAgICBwcm9maWxlRWRpdFN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG5cbiAgICBjb25zdCBhcGlPcHRpb25zID0ge1xuICAgICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiNTFiODI1OWQtZjhkMS00YjdjLWI0NDMtMTk0NjIwZWRjYTI0XCIsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogaW5wdXRzW1wicHJvZmlsZS1tb2RhbC1uYW1lXCJdLFxuICAgICAgICBhYm91dDogaW5wdXRzW1wicHJvZmlsZS1tb2RhbC1qb2JcIl0sXG4gICAgICB9KSxcbiAgICB9O1xuXG4gICAgbmV3IEFwaShhcGlPcHRpb25zKVxuICAgICAgLnVwZGF0ZVVzZXJJbmZvKClcbiAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzdWx0Lm5hbWUsIHJlc3VsdC5hYm91dCk7XG4gICAgICAgIHByb2ZpbGVFZGl0U3VibWl0QnV0dG9uLnRleHRDb250ZW50ID1cbiAgICAgICAgICBwcm9maWxlRWRpdFN1Ym1pdEJ1dHRvblRleHRPcmlnaW5hbDtcbiAgICAgICAgcHJvZmlsZUZvcm0uY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVyck1lc3NhZ2UpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyTWVzc2FnZSk7XG4gICAgICAgIHByb2ZpbGVGb3JtLmNsb3NlKCk7XG4gICAgICB9KTtcblxuICAgIC8vcHJvZmlsZUZvcm0ucmVzZXQoKTtcbiAgfSxcbn0pO1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4vKiBIYW5kbGUgcHJvZmlsZSBwZW4gYnV0dG9uIGNsaWNrICovXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gZmlsbCB0aGUgcHJvZmlsZSBmb3JtIG9uY2UgdmlzaWJsZVxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xuICBjb25zdCBwcm9maWxlID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZU1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZS5wcm9maWxlTmFtZTtcbiAgcHJvZmlsZU1vZGFsSm9iSW5wdXQudmFsdWUgPSBwcm9maWxlLnByb2ZpbGVKb2I7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRQcm9maWxlKCkge1xuICBmb3JtVmFsaWRhdG9yc1twcm9maWxlRm9ybU5hbWVdLnJlc2V0VmFsaWRhdGlvbigpO1xuICBmaWxsUHJvZmlsZUZvcm0oKTtcbiAgcHJvZmlsZUZvcm0ub3BlbigpO1xufVxuXG5wcm9maWxlUGVuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVFZGl0UHJvZmlsZSk7XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbi8qIEhhbmRsZSBjYXJkcyBhZGRpdGlvbiBsb2dpYyAgICAgKi9cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuY29uc3QgbW9kYWxDYXJkID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLW1vZGFsXCIpO1xuXG4vLyBUaGUgaGFuZGxlRm9ybVN1Ym1pdCBpcyBpbml0aWFsaXplZCB3aXRoIGR1bW15XG4vLyBmdW5jdGlvbi4gVGhpcyB3aWxsIGJlIHNldCBpbiB0aGUgZGVsZXRlRXZlbnRIYW5kbGVyIGluIHRoZSBjcmVhdGVDYXJkKCkgZnVuY3Rpb25cbmNvbnN0IGRlbGV0ZUNhcmRDb25maXJtYXRpb24gPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIG1vZGFsU2VsZWN0b3I6IFwiI2RlbGV0ZS1jYXJkLWNvbmZpcm1hdGlvblwiLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoKSA9PiB7fSxcbn0pO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0pIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBkYXRhOiBpdGVtLFxuICAgIHNlbGVjdG9yOiBjYXJkVGVtcGxhdGVJRCxcbiAgICBjbGlja0V2ZW50SGFuZGxlcjogKCkgPT4ge1xuICAgICAgbW9kYWxDYXJkLm9wZW4oe1xuICAgICAgICBzcmM6IGl0ZW0ubGluayxcbiAgICAgICAgYWx0OiBpdGVtLm5hbWUsXG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgZGVsZXRlRXZlbnRIYW5kbGVyOiAoKSA9PiB7XG4gICAgICBjb25zdCBhcGlPcHRpb25zID0ge1xuICAgICAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiNTFiODI1OWQtZjhkMS00YjdjLWI0NDMtMTk0NjIwZWRjYTI0XCIsXG4gICAgICAgIH0sXG4gICAgICAgIGNhcmRJZDogaXRlbS5pbWFnZUlkLFxuICAgICAgfTtcblxuICAgICAgZGVsZXRlQ2FyZENvbmZpcm1hdGlvbi5vcGVuKCk7XG4gICAgICBkZWxldGVDYXJkQ29uZmlybWF0aW9uLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgICAgIG5ldyBBcGkoYXBpT3B0aW9ucylcbiAgICAgICAgICAuZGVsZXRlQ2FyZCgpXG4gICAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgY2FyZC5yZW1vdmVDYXJkRWxlbWVudCgpO1xuICAgICAgICAgICAgZGVsZXRlQ2FyZENvbmZpcm1hdGlvbi5jbG9zZSgpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBsaWtlRXZlbnRIYW5kbGVyOiAoKSA9PiB7XG4gICAgICBjb25zdCBhcGlPcHRpb25zID0ge1xuICAgICAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiNTFiODI1OWQtZjhkMS00YjdjLWI0NDMtMTk0NjIwZWRjYTI0XCIsXG4gICAgICAgIH0sXG4gICAgICAgIGNhcmRJZDogaXRlbS5pbWFnZUlkLFxuICAgICAgICBjYXJkTGlrZWQ6IGNhcmQuaXNDYXJkTGlrZWQoKSxcbiAgICAgIH07XG5cbiAgICAgIG5ldyBBcGkoYXBpT3B0aW9ucylcbiAgICAgICAgLnVwZGF0ZUxpa2VDYXJkKClcbiAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgIGlmIChjaGVja0NhcmRMaWtlKHJlc3VsdC5saWtlcykpIHtcbiAgICAgICAgICAgIGNhcmQubGlrZUNhcmQoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FyZC51bmxpa2VDYXJkKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzdWx0Lmxpa2VzLmxlbmd0aCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyTWVzc2FnZSkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGVyck1lc3NhZ2UpO1xuICAgICAgICB9KTtcbiAgICB9LFxuICB9KTtcbiAgcmV0dXJuIGNhcmQ7XG59XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbi8qIE5ldyBjYXJkcyBhZGRpdGlvbiBsb2dpYyAgICAgICAgKi9cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbmNvbnN0IGFkZENhcmRTdWJtaXRCdXR0b24gPSBkb2N1bWVudFxuICAucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZFwiKVxuICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0XCIpO1xuXG5jb25zdCBhZGRDYXJkU3VibWl0QnV0dG9uVGV4dE9yaWdpbmFsID0gYWRkQ2FyZFN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcblxuLy8gSGFuZGxlIHRoZSBBREQgYnV0dG9uICh0byBhZGQgY2FyZHMpXG4vLyBtb2RhbFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0XG5jb25zdCBhZGRDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgbW9kYWxTZWxlY3RvcjogXCIjYWRkLWNhcmRcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGlucHV0cykgPT4ge1xuICAgIGFkZENhcmRTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuXG4gICAgY29uc3QgaXRlbSA9IHtcbiAgICAgIG5hbWU6IGlucHV0c1tcImFkZC1jYXJkLXRpdGxlXCJdLFxuICAgICAgbGluazogaW5wdXRzW1wiYWRkLWNhcmQtaW1hZ2UtdXJsXCJdLFxuICAgIH07XG5cbiAgICBjb25zdCBhcGlPcHRpb25zID0ge1xuICAgICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiNTFiODI1OWQtZjhkMS00YjdjLWI0NDMtMTk0NjIwZWRjYTI0XCIsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGl0ZW0pLFxuICAgIH07XG5cbiAgICBuZXcgQXBpKGFwaU9wdGlvbnMpXG4gICAgICAuYWRkTmV3UGljdHVyZSgpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZCh7XG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICAgIGxpbms6IGRhdGEubGluayxcbiAgICAgICAgICBvd25lckluZDogdHJ1ZSxcbiAgICAgICAgICBjYXJkTGlrZWQ6IGZhbHNlLFxuICAgICAgICAgIGxpa2VzOiAwLFxuICAgICAgICAgIGltYWdlSWQ6IGRhdGEuX2lkLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdldENhcmRFbGVtZW50KCk7XG4gICAgICAgIGNhcmRzTGlzdC5wcmVwZW5kSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIGFkZENhcmRTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBhZGRDYXJkU3VibWl0QnV0dG9uVGV4dE9yaWdpbmFsO1xuICAgICAgICBhZGRDYXJkRm9ybS5yZXNldCgpO1xuICAgICAgICBhZGRDYXJkRm9ybS5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyTWVzc2FnZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJNZXNzYWdlKTtcbiAgICAgICAgYWRkQ2FyZEZvcm0uY2xvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgLy9hZGRDYXJkRm9ybS5yZXNldCgpO1xuICB9LFxufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUNhcmRBZGRCdXR0b25DbGljaygpIHtcbiAgYWRkQ2FyZEZvcm0ub3BlbigpO1xufVxuXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDYXJkQWRkQnV0dG9uQ2xpY2spO1xuXG5mdW5jdGlvbiBhZGRJbml0aWFsQ2FyZHMoaW5pdGlhbENhcmRzKSB7XG4gIGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKFxuICAgIHtcbiAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoaXRlbSk7XG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZXRDYXJkRWxlbWVudCgpO1xuICAgICAgICBjYXJkc0xpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICB9LFxuICAgIH0sXG4gICAgXCIuY29udGVudF9fbGlzdFwiXG4gICk7XG5cbiAgY2FyZHNMaXN0LnJlbmRlckl0ZW1zKCk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVByb2ZpbGVBdmF0YXIobmV3QXZhdGFyKSB7XG4gIGNvbnN0IG9sZEF2YXRhciA9IHByb2ZpbGVBdmF0YXIuc3JjO1xuICBwcm9maWxlQXZhdGFyLnNyYyA9IG5ld0F2YXRhcjtcblxuICBwcm9maWxlQXZhdGFyLm9uZXJyb3IgPSAoKSA9PiB7XG4gICAgcHJvZmlsZUF2YXRhci5zcmMgPSBvbGRBdmF0YXI7XG4gICAgY29uc29sZS5sb2coXCJFcnJvcjogTm90IGFibGUgdG8gbG9hZCBuZXcgQXZhdGFyLiBBdmF0YXIgdW5jaGFuZ2VkISFcIik7XG4gIH07XG59XG5cbmNvbnN0IGF2YXRhckVkaXRTdWJtaXRCdXR0b24gPSBkb2N1bWVudFxuICAucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItZWRpdFwiKVxuICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0XCIpO1xuXG5jb25zdCBhdmF0YXJFZGl0U3VibWl0QnV0dG9uVGV4dE9yaWdpbmFsID0gYXZhdGFyRWRpdFN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcblxuY29uc3QgdXBkYXRlQXZhdGFyRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgbW9kYWxTZWxlY3RvcjogXCIjYXZhdGFyLWVkaXRcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGlucHV0cykgPT4ge1xuICAgIGNvbnN0IG5ld0F2YXRhckluZm8gPSB7XG4gICAgICBhdmF0YXI6IGlucHV0c1tcImF2YXRhci11cmxcIl0sXG4gICAgfTtcblxuICAgIGNvbnN0IGFwaU9wdGlvbnMgPSB7XG4gICAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI1MWI4MjU5ZC1mOGQxLTRiN2MtYjQ0My0xOTQ2MjBlZGNhMjRcIixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkobmV3QXZhdGFySW5mbyksXG4gICAgfTtcbiAgICBhdmF0YXJFZGl0U3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICBuZXcgQXBpKGFwaU9wdGlvbnMpXG4gICAgICAudXBkYXRlQXZhdGFyKClcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIHVwZGF0ZVByb2ZpbGVBdmF0YXIoaW5wdXRzW1wiYXZhdGFyLXVybFwiXSk7XG4gICAgICAgIGF2YXRhckVkaXRTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBhdmF0YXJFZGl0U3VibWl0QnV0dG9uVGV4dE9yaWdpbmFsO1xuICAgICAgICB1cGRhdGVBdmF0YXJGb3JtLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJNZXNzYWdlKSA9PiB7XG4gICAgICAgIGF2YXRhckVkaXRTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBhdmF0YXJFZGl0U3VibWl0QnV0dG9uVGV4dE9yaWdpbmFsO1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJNZXNzYWdlKTtcbiAgICAgICAgdXBkYXRlQXZhdGFyRm9ybS5jbG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICAvL2FkZENhcmRGb3JtLnJlc2V0KCk7XG4gIH0sXG59KTtcblxuZnVuY3Rpb24gYWRkUHJvZmlsZUluZm8ocHJvZmlsZUluZm8sIGluaXRpYWxDYXJkcykge1xuICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHByb2ZpbGVJbmZvLm5hbWU7XG4gIHByb2ZpbGVOYW1lVGFnLnRleHRDb250ZW50ID0gcHJvZmlsZUluZm8uYWJvdXQ7XG4gIHByb2ZpbGVBdmF0YXIuc3JjID0gcHJvZmlsZUluZm8uYXZhdGFyO1xuICBwcm9maWxlQXZhdGFyLmFsdCA9IGBQcm9maWxlIG9mICR7cHJvZmlsZUluZm8ubmFtZX1gO1xuXG4gIHByb2ZpbGVBdmF0YXIub25sb2FkID0gKCkgPT4ge1xuICAgIGFkZEluaXRpYWxDYXJkcyhpbml0aWFsQ2FyZHMpO1xuICB9O1xuICBwcm9maWxlQXZhdGFyLm9uZXJyb3IgPSAoKSA9PiBjb25zb2xlLmxvZyhcIkVycm9yOiBOb3QgYWJsZSB0byBsb2FkIEF2YXRhciEhXCIpO1xufVxuXG5wcm9maWxlQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgKGV2ZW50KSA9PiB7XG4gIGF2YXRhckVkaXQuY2xhc3NMaXN0LmFkZChcInByb2ZpbGVfX2F2YXRhci1lZGl0X3Nob3dcIik7XG59KTtcblxuYXZhdGFyRWRpdC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgKGV2ZW50KSA9PiB7XG4gIGF2YXRhckVkaXQuY2xhc3NMaXN0LnJlbW92ZShcInByb2ZpbGVfX2F2YXRhci1lZGl0X3Nob3dcIik7XG59KTtcblxuYXZhdGFyRWRpdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gIHVwZGF0ZUF2YXRhckZvcm0ub3BlbigpO1xufSk7XG5cbi8vIHByb2ZpbGVBdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsIChldmVudCkgPT4ge1xuLy8gYXZhdGFyRWRpdC5jbGFzc0xpc3QucmVtb3ZlKFwicHJvZmlsZV9fYXZhdGFyLWVkaXRfc2hvd1wiKTtcbi8vIH0pO1xuXG4vLyBUaGlzIHZhcmlhYmxlIHdpbGwgYmUgdXBkYXRlZCBpbiBhZGRJbml0aWFsQ2FyZHMoKSBmdW5jdGlvbixcbi8vIHdoaWNoIHdpbGwgYmUgY2FsbGVkIGluIHRoZSBwcm9taXNlLCBhZnRlciB0aGUgY2FyZHMgaGF2ZSBiZWVuIHJlYWQuXG4vLyBjYXJkc0xpc3QgaXMgcmVxdWlyZWQgbGF0ZXIsIHdoZW4gd2UgYWRkIG5ldyBjYXJkcyB0byB0aGUgcGFnZS5cbi8vIFRoaXMgdmFyaWFibGUgY2Fubm90IGJlIGEgY29uc3QsIGFzIEkgY2Fubm90IGFzc2lnbiBhIG5ldyB2YWx1ZVxuXG5sZXQgY2FyZHNMaXN0ID0gXCJcIjtcblxuLy9wcm9maWxlSW5mbyBjb250YWlucyB0aGUgdXNlciBkZXRhaWxzIChsaWtlIHRoZWlyIGlkLCBuYW1lIGFuZCBhYm91dCBpbmZvKVxuLy9JdCB3aWxsIGJlIGZpbGxlZCB2aWEgYW4gQVBJIGNhbGxcbmNvbnN0IHByb2ZpbGVJbmZvID0ge307XG5cbi8vQ2hlY2tzIGlmIHRoZSB1c2VyIElEIGlzIG9uZSBvZiB0aGUgSURzIHdobyBsaWtlZCB0aGUgcGhvdG9cbmZ1bmN0aW9uIGNoZWNrQ2FyZExpa2UobGlrZXMpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaWtlcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChsaWtlc1tpXS5faWQgPT0gcHJvZmlsZUluZm8uX2lkKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBsb2FkSW5pdGlhbFBhZ2UoKSB7XG4gIGNvbnN0IGluaXRpYWxDYXJkcyA9IFtdO1xuXG4gIGNvbnN0IGFwaU9wdGlvbnMgPSB7XG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXG4gICAgaGVhZGVyczoge1xuICAgICAgYXV0aG9yaXphdGlvbjogXCI1MWI4MjU5ZC1mOGQxLTRiN2MtYjQ0My0xOTQ2MjBlZGNhMjRcIixcbiAgICB9LFxuICB9O1xuXG4gIGNvbnN0IGNhcmREYXRhID0gbmV3IEFwaShhcGlPcHRpb25zKVxuICAgIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KTtcblxuICBjb25zdCB1c2VyRGF0YSA9IG5ldyBBcGkoYXBpT3B0aW9ucylcbiAgICAuZ2V0VXNlckluZm8oKVxuICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KTtcblxuICBuZXcgQXBpKGFwaU9wdGlvbnMpLnBlcmZvcm1Qcm9taXNlQWxsKFtjYXJkRGF0YSwgdXNlckRhdGFdKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICBwcm9maWxlSW5mby5uYW1lID0gcmVzdWx0WzFdLm5hbWU7XG4gICAgcHJvZmlsZUluZm8uYWJvdXQgPSByZXN1bHRbMV0uYWJvdXQ7XG4gICAgcHJvZmlsZUluZm8uYXZhdGFyID0gcmVzdWx0WzFdLmF2YXRhcjtcbiAgICBwcm9maWxlSW5mby5faWQgPSByZXN1bHRbMV0uX2lkO1xuXG4gICAgLy9vd25lckluZCB3aWxsIGhlbHAgdXMgdG8gZGV0ZXJtaW5lIGlmIHRoZSBwaG90byBpcyBvd25lZCBieSB0aGUgdXNlclxuICAgIC8vIElmIG93bmVkIGJ5IHRoZSB1c2VyLCB3ZSB3aWxsIGFkZCB0aGUgZGVsZXRlIGJpbiB0byB0aGUgcGhvdG8sXG4gICAgLy8gZWxzZSB3ZSB3aWxsIG5vdCBhZGQgZGVsZXRlIGJpbiB0byB0aGUgcGhvdG9cbiAgICByZXN1bHRbMF0uZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgY29uc3Qgb3duZXJJbmQgPSBwcm9maWxlSW5mby5faWQgPT09IGVsZW1lbnQub3duZXIuX2lkO1xuXG4gICAgICBjb25zdCBjYXJkTGlrZWQgPSBjaGVja0NhcmRMaWtlKGVsZW1lbnQubGlrZXMpO1xuXG4gICAgICBpbml0aWFsQ2FyZHMucHVzaCh7XG4gICAgICAgIG5hbWU6IGVsZW1lbnQubmFtZSxcbiAgICAgICAgbGluazogZWxlbWVudC5saW5rLFxuICAgICAgICBsaWtlczogZWxlbWVudC5saWtlcy5sZW5ndGgsXG4gICAgICAgIG93bmVySW5kOiBvd25lckluZCxcbiAgICAgICAgaW1hZ2VJZDogZWxlbWVudC5faWQsXG4gICAgICAgIGNhcmRMaWtlZDogY2FyZExpa2VkLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBhZGRQcm9maWxlSW5mbyhwcm9maWxlSW5mbywgaW5pdGlhbENhcmRzKTtcbiAgfSk7XG59XG5cbmxvYWRJbml0aWFsUGFnZSgpO1xuIiwiY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX3Byb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBwcm9maWxlTmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXG4gICAgICBwcm9maWxlSm9iOiB0aGlzLl9wcm9maWxlSm9iLnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyhwcm9maWxlTmFtZSwgcHJvZmlsZUpvYikge1xuICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gcHJvZmlsZU5hbWU7XG4gICAgdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IHByb2ZpbGVKb2I7XG4gIH1cbn1cblxuZXhwb3J0IHsgVXNlckluZm8gfTtcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IpIHtcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9tb2RhbEltYWdlID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtZXhwYW5kZWRcIik7XG4gICAgdGhpcy5fbW9kYWxUZXh0ID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtbGFiZWxcIik7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIG9wZW4oeyBzcmMsIGFsdCB9KSB7XG4gICAgdGhpcy5fbW9kYWxJbWFnZS5zcmMgPSBzcmM7XG4gICAgdGhpcy5fbW9kYWxJbWFnZS5hbHQgPSBhbHQ7XG4gICAgdGhpcy5fbW9kYWxUZXh0LnRleHRDb250ZW50ID0gYWx0O1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuXG5leHBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9O1xuIl0sIm5hbWVzIjpbIlNlY3Rpb24iLCJjb25zdHJ1Y3RvciIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsInRoaXMiLCJfcmVuZGVyZXIiLCJfaW5pdGlhbEFycmF5IiwiX2NvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInJlbmRlckl0ZW1zIiwiZm9yRWFjaCIsImFkZEl0ZW0iLCJlbGVtZW50IiwiYXBwZW5kIiwicHJlcGVuZEl0ZW0iLCJwcmVwZW5kIiwiUG9wdXAiLCJtb2RhbFNlbGVjdG9yIiwiX21vZGFsIiwiX21vZGFsQ2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJvcGVuIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9mb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsInNldFN1Ym1pdEFjdGlvbiIsIm5ld1N1Ym1pdEhhbmRsZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJDYXJkIiwiZGF0YSIsInNlbGVjdG9yIiwiY2xpY2tFdmVudEhhbmRsZXIiLCJkZWxldGVFdmVudEhhbmRsZXIiLCJsaWtlRXZlbnRIYW5kbGVyIiwiX3NyYyIsImxpbmsiLCJfYWx0IiwiX3RleHRDb250ZW50IiwiX2xpa2VzIiwibGlrZXMiLCJfb3duZXJJbmQiLCJvd25lckluZCIsIl9jYXJkTGlrZWQiLCJjYXJkTGlrZWQiLCJfc2VsZWN0b3IiLCJfY2xpY2tFdmVudEhhbmRsZXIiLCJfZGVsZXRlRXZlbnRIYW5kbGVyIiwiX2xpa2VFdmVudEhhbmRsZXIiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2ZpbGxJbWFnZUNhcmQiLCJfY2FyZEltYWdlIiwic3JjIiwiYWx0IiwiX2NhcmRMYWJlbCIsInRleHRDb250ZW50IiwiX2NhcmRMaWtlcyIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsIl9kZWxldGVDYXJkQnV0dG9uIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJldmVudCIsIl9jYXJkTGlrZUJ1dHRvbiIsImlzQ2FyZExpa2VkIiwicmVtb3ZlQ2FyZEVsZW1lbnQiLCJfZWxlbWVudCIsInVwZGF0ZUxpa2VzIiwiZ2V0Q2FyZEVsZW1lbnQiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnRGljdCIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiaWQiLCJfY29uZmlnRGljdCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0luVmFsaWRJbnB1dCIsIl9kaXNhYmxlU3VibWl0IiwiX2J1dHRvbkVsZW1lbnQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNldEF0dHJpYnV0ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJBcGkiLCJvcHRpb25zIiwiX29wdGlvbnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhlbiIsImdldFVzZXJJbmZvIiwidXBkYXRlVXNlckluZm8iLCJtZXRob2QiLCJib2R5IiwiYWRkTmV3UGljdHVyZSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJ1cGRhdGVMaWtlQ2FyZCIsInVwZGF0ZUF2YXRhciIsInBlcmZvcm1Qcm9taXNlQWxsIiwicHJvbWlzZUxpc3QiLCJhbGwiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiaW5wdXRFcnJvclNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZXJyb3JDbGFzcyIsImFsbEZvcm1zIiwicHJvZmlsZVBlbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZU5hbWVUYWciLCJwcm9maWxlQXZhdGFyIiwiYXZhdGFyRWRpdCIsInByb2ZpbGVNb2RhbCIsInByb2ZpbGVGb3JtTmFtZSIsInByb2ZpbGVNb2RhbE5hbWVJbnB1dCIsInByb2ZpbGVNb2RhbEpvYklucHV0IiwiYWRkQ2FyZEJ1dHRvbiIsImZvcm1WYWxpZGF0b3JzIiwiZm9ybSIsImZvcm1WYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwicHJvZmlsZUpvYiIsInNldFVzZXJJbmZvIiwicHJvZmlsZUVkaXRTdWJtaXRCdXR0b24iLCJwcm9maWxlRWRpdFN1Ym1pdEJ1dHRvblRleHRPcmlnaW5hbCIsInByb2ZpbGVGb3JtIiwiaW5wdXRzIiwiYXBpT3B0aW9ucyIsImF1dGhvcml6YXRpb24iLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJyZXN1bHQiLCJjYXRjaCIsImVyck1lc3NhZ2UiLCJjb25zb2xlIiwibG9nIiwicmVzZXRWYWxpZGF0aW9uIiwicHJvZmlsZSIsImZpbGxQcm9maWxlRm9ybSIsIm1vZGFsQ2FyZCIsIl9tb2RhbEltYWdlIiwiX21vZGFsVGV4dCIsImRlbGV0ZUNhcmRDb25maXJtYXRpb24iLCJjcmVhdGVDYXJkIiwiaXRlbSIsImNhcmQiLCJpbWFnZUlkIiwiZXJyIiwiY2hlY2tDYXJkTGlrZSIsImxlbmd0aCIsImFkZENhcmRTdWJtaXRCdXR0b24iLCJhZGRDYXJkU3VibWl0QnV0dG9uVGV4dE9yaWdpbmFsIiwiYWRkQ2FyZEZvcm0iLCJjYXJkRWxlbWVudCIsIl9pZCIsImNhcmRzTGlzdCIsImF2YXRhckVkaXRTdWJtaXRCdXR0b24iLCJhdmF0YXJFZGl0U3VibWl0QnV0dG9uVGV4dE9yaWdpbmFsIiwidXBkYXRlQXZhdGFyRm9ybSIsIm5ld0F2YXRhckluZm8iLCJhdmF0YXIiLCJuZXdBdmF0YXIiLCJvbGRBdmF0YXIiLCJvbmVycm9yIiwidXBkYXRlUHJvZmlsZUF2YXRhciIsInByb2ZpbGVJbmZvIiwiaSIsImluaXRpYWxDYXJkcyIsImNhcmREYXRhIiwidXNlckRhdGEiLCJvd25lciIsInB1c2giLCJvbmxvYWQiLCJhZGRJbml0aWFsQ2FyZHMiLCJhZGRQcm9maWxlSW5mbyIsImxvYWRJbml0aWFsUGFnZSJdLCJzb3VyY2VSb290IjoiIn0=